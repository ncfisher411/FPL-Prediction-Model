"0","set.seed(123)"
"0",""
"0","gk <- trends2 %>% ungroup() %>% "
"0","  select(all_of(c(""Player"", ""Points"")), all_of(gk_rows)) %>%"
"0","  mutate_all(~ ifelse(is.na(.),0,.))"
"0",""
"0","train_index <- sample(1:nrow(gk), nrow(gk) * 0.8)"
"0","train_data <- gk[train_index, ]"
"0","x_train <- train_data %>% select(-c(""Player""))"
"0","  "
"0","y_train <- train_data %>% select(Points) %>% data.matrix()"
"0","test_data <- gk[-train_index, ]"
"0","x_test <- test_data %>% select(-c(""Player"")) %>% data.matrix()"
"0","y_test <- test_data %>% select(Points) %>% data.matrix()"
"0","#dim(train_data)"
"0","#dim(test_data)"
"0",""
"0","tr_control <- trainControl(method = ""repeatedcv"", number = 10, repeats=3, search = ""random"")"
"0",""
"0","tunegrid <- expand.grid(.mtry=41)"
"0",""
"0","rf_model <- train(Points~., data = x_train, method = ""rf"", tuneGrid=tunegrid,"
"0","              trControl=tr_control, importance=T, nodesize=14, ntree=200,"
"0","              maxnodes=12)"
"0",""
"0","temp <- train_data %>% select(Player, Points)"
"0","one <- predict(rf_model, x_train) %>% data.frame() %>%"
"0","  rename(Predicted=1) %>% cbind(temp) %>%"
"0","  mutate(Points=log(Points)) %>% mutate(Predicted=log(Predicted)) %>%"
"0","  arrange(-Points) %>%"
"0","  mutate(row=row_number())"
"0","plot <- ggplot(one, aes(x=row, y=Points, color=""Observed point totals"")) +"
"0","  geom_point() +"
"0","  geom_point(aes(y=Predicted, color=""Predicted point totals"")) +"
"0","  geom_smooth(aes(y=Predicted, color=""Smoothed best fit - Training"")) +"
"0","  geom_smooth(aes(y=Points, color=""Smoothed best fit - Observed"")) +"
"0","  theme(axis.text.x = element_blank(),"
"0","        legend.title = element_blank()) +"
"0","  xlab(""Player"") + ylab(""Log Points"") +"
"0","  ggtitle(""Lowess curve: Validation of goalkeepers random forest model, Training model"")"
"0","plot"
"1","[38;5;253m`geom_smooth()` using method = 'loess' and formula = 'y ~ x'[39m
"
"1","[38;5;253m`geom_smooth()` using method = 'loess' and formula = 'y ~ x'[39m
"
