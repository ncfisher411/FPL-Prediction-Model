"0","points <- gk$Points %>% as.matrix()"
"0","temp <- trends2 %>% ungroup() %>%"
"0","  select(-c(""Points"", ""Bonus"", ""Position"")) %>%"
"0","  mutate_all(~ ifelse(is.na(.),0,.)) %>% data.matrix()"
"0","one <- glmnet(temp, points, alpha=0)"
"0","five <- cv.glmnet(temp, points, alpha=0)"
"0","lambda <- five$lambda.min"
"0",""
"0","set.seed(123)"
"0",""
"0","gk <- trends2 %>% ungroup() %>% "
"0","  select(all_of(c(""Player"", ""Points"")), all_of(gk_rows)) %>%"
"0","  mutate_all(~ ifelse(is.na(.),0,.))"
"0",""
"0","train_index <- sample(1:nrow(gk), nrow(gk) * 0.8)"
"0","train_data <- gk[train_index, ]"
"0","x_train <- train_data %>% select(-c(""Player"", ""Points""))"
"0","  "
"0","y_train <- train_data %>% select(Points) %>% data.matrix()"
"0","test_data <- gk[-train_index, ]"
"0","x_test <- test_data %>% select(-c(""Player"", ""Points"")) %>% data.matrix()"
"0","y_test <- test_data %>% select(Points) %>% data.matrix()"
"0","#dim(train_data)"
"0","#dim(test_data)"
"0",""
"0","ridge_model <- glmnet(x_train, y_train, alpha=0, lambda = lambda)"
"0","prediction <- predict(ridge_model, newx=x_test)"
"0","mse <- mean((y_test-prediction)^2)"
"0","rmse <- sqrt(mse)"
"0","rsq <- 1-(sum((y_test-prediction)^2) / sum((y_test-mean(y_test))^2))"
"0",""
"0","x_test <- keepers %>% filter(Season==2023) %>% "
"0","  select(all_of(gk_rows)) %>%"
"0","  mutate_all(~ ifelse(is.na(.),0,.)) %>%"
"0","  data.matrix()"
"0","temp <- keepers %>% filter(Season==2023) %>%"
"0","  select(Player, Points)"
"0","prediction <- predict(ridge_model, newx=x_test) %>% data.frame() %>%"
"0","  cbind(temp) %>% rename(Predicted=`s0`) %>% "
"0","  mutate(Validation=Predicted-Points)"
"0","avg_error <- mean(prediction$Validation)"
"0","max_error <- max(prediction$Validation)"
"0","min_error <- min(prediction$Validation)"
"0",""
"0","temp <- data.frame(MSE=mse, RMSE=rmse, `R^2`=rsq, Avg_error=avg_error,"
"0","                            Max_error=max_error, Min_error=min_error) %>%"
"0","  mutate(Position=""GKP"") %>% mutate(Model=""Ridge Regression"") %>%"
"0","  select(Model, Position, everything())"
"0","model_summary <- model_summary %>% rbind(temp)"
