"0","set.seed(123)"
"0",""
"0","mid <- trends %>% ungroup() %>% filter(Position==""MID"") %>%"
"0","  select(all_of(c(""Player"", ""Points"")), all_of(m_rows)) %>%"
"0","  mutate_all(~ ifelse(is.na(.),0,.))"
"0",""
"0","one <- sample(seq_len(nrow(mid)), size=round(0.8*nrow(mid)), replace = F)"
"0","two <- setdiff(seq_len(nrow(mid)), one)"
"0",""
"0","mid_xtrain <- mid[one, ] %>% select(-Player)"
"0","mid_xtest <- mid[two, ]"
"0","temp <- mid_xtest %>% select(Player)"
"0","mid_xtest <- mid_xtest %>% select(-Player)"
"0",""
"0","points <- mid %>% select(Player, Points)"
"0","ols_mid <- lm(Points ~ ., data=mid_xtrain)"
"0","prediction <- predict(ols_mid, newdata=mid_xtest) %>% data.frame() %>%"
"0","  rename(Predicted=1) %>% cbind(temp) %>% left_join(points, by=""Player"") %>%"
"0","  mutate(Validation=Predicted-Points)"
"0","mse <- mean((x_test$Points-prediction$Predicted)^2)"
"0","rmse <- sqrt(mse)"
"0","rsq <- 1-(sum((x_test$Points-prediction$Predicted)^2) / sum((x_test$Points-mean(x_test$Points))^2))"
"0","avg_error <- mean(prediction$Validation)"
"0","max_error <- max(prediction$Validation)"
"0","min_error <- min(prediction$Validation)"
"0",""
"0","temp <- data.frame(MSE=mse, RMSE=rmse, `R^2`=rsq, Avg_error=avg_error,"
"0","                            Max_error=max_error, Min_error=min_error) %>%"
"0","  mutate(Position=""MID"") %>% mutate(Model=""OLS"") %>%"
"0","  select(Model, Position, everything())"
"0","model_summary <- model_summary %>% rbind(temp)"
