"0","set.seed(123)"
"0",""
"0","fwd <- trends %>% ungroup() %>% filter(Position==""FWD"") %>%"
"0","  select(all_of(c(""Player"", ""Points"")), all_of(f_rows)) %>%"
"0","  mutate_all(~ ifelse(is.na(.),0,.))"
"0",""
"0","one <- sample(seq_len(nrow(fwd)), size=round(0.8*nrow(fwd)), replace = F)"
"0","two <- setdiff(seq_len(nrow(fwd)), one)"
"0",""
"0","x_train <- fwd[one, ] %>% select(-Player)"
"0","x_test <- fwd[two, ]"
"0","temp <- x_test %>% select(Player)"
"0","x_test <- x_test %>% select(-Player)"
"0",""
"0","points <- fwd %>% select(Player, Points)"
"0","ols_fwd <- lm(Points ~ ., data=x_train)"
"0","prediction <- predict(ols_fwd, newdata=x_test) %>% data.frame() %>%"
"0","  rename(Predicted=1) %>% cbind(temp) %>% left_join(points, by=""Player"") %>%"
"0","  mutate(Validation=Predicted-Points)"
"0","mse <- mean((x_test$Points-prediction$Predicted)^2)"
"0","rmse <- sqrt(mse)"
"0","rsq <- 1-(sum((x_test$Points-prediction$Predicted)^2) / sum((x_test$Points-mean(x_test$Points))^2))"
"0","avg_error <- mean(prediction$Validation)"
"0","max_error <- max(prediction$Validation)"
"0","min_error <- min(prediction$Validation)"
"0",""
"0","model_summary <- data.frame(MSE=mse, RMSE=rmse, `R^2`=rsq, Avg_error=avg_error,"
"0","                            Max_error=max_error, Min_error=min_error) %>%"
"0","  mutate(Position=""FWD"") %>% mutate(Model=""OLS"") %>%"
"0","  select(Model, Position, everything())"
