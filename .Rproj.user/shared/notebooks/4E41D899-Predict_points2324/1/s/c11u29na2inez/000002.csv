"0","keepers <- read.csv(""keepers_new_players.csv"")"
"0","  "
"0",""
"0","set.seed(123)"
"0",""
"0","train_index <- sample(1:nrow(gk), nrow(gk) * 0.8)"
"0","train_data <- gk[train_index, ]"
"0","x_train <- train_data %>% select(-c(""Player""))"
"0","  "
"0","y_train <- train_data %>% select(Points) %>% data.matrix()"
"0","test_data <- gk[-train_index, ]"
"0","x_test <- test_data %>% select(-c(""Player"")) %>% data.matrix()"
"0","y_test <- test_data %>% select(Points) %>% data.matrix()"
"0","#dim(train_data)"
"0","#dim(test_data)"
"0",""
"0","tr_control <- trainControl(method = ""repeatedcv"", number = 10, repeats=3, search = ""grid"")"
"0","# model <- train(Points~., data = x_train, method = ""rf"", trControl = tr_control, ntree=100)"
"0","# print(model)"
"0","#best mtry=37"
"0","# tr_control <- trainControl(method = ""repeatedcv"", number = 10, repeats=3, search = ""random"")"
"0","# model <- train(Points~., data = x_train, method = ""rf"", trControl = tr_control, ntree=100)"
"0","# print(model)"
"0","# Best is grid, mtry=40"
"0","tunegrid <- expand.grid(.mtry=37)"
"0",""
"0","# one <- list()"
"0","# for (maxnodes in c(5:15)){"
"0","#   set.seed(123)"
"0","#   rf_maxnode <- train(Points~., data=x_train, method=""rf"", tuneGrid=tunegrid,"
"0","#                       trControl=tr_control, importance=T, nodesize=14,"
"0","#                       maxnodes=maxnodes, ntree=100)"
"0","#   current_iteration <- toString(maxnodes)"
"0","#   one[[current_iteration]] <- rf_maxnode"
"0","# }"
"0","# two <- resamples(one)"
"0","# summary(two)"
"0","# best maxnodes is 5"
"0",""
"0","# three <- list()"
"0","# for(ntree in c(50, 100, 150, 200, 250, 300, 350, 400, 450, 500, 550, 600, 650, 700)) {"
"0","#   set.seed(123)"
"0","#   rf_maxtrees <- train(Points~., data=x_train, method=""rf"", tuneGrid=tunegrid,"
"0","#                        trControl=tr_control, importance=T, nodesize=14,"
"0","#                        maxnodes=5, ntree=ntree)"
"0","#   key <- toString(ntree)"
"0","#   three[[key]] <- rf_maxtrees"
"0","# }"
"0","# four <- resamples(three)"
"0","# summary(four)"
"0","# best trees is 50"
"0",""
"0","gk_model <- train(Points~., data = x_train, method = ""rf"", tuneGrid=tunegrid,"
"0","              trControl=tr_control, importance=T, nodesize=5, ntree=50,"
"0","              maxnodes=12)"
"0",""
"0","temp <- keepers %>% select(Player, Position)"
"0","one <- keepers %>% select(all_of(gk_rows)) %>%"
"0","  mutate_all(~ ifelse(is.na(.),0,.)) %>% data.matrix()"
"0",""
"0","prediction <- predict(gk_model, one) %>% data.frame() %>%"
"0","  cbind(temp$Player) %>% cbind(temp$Position) %>%"
"0","  rename(Predicted_Points=1, Player=2, Position=3) %>%"
"0","  mutate(Position=""GKP"") %>%"
"0","  select(Player, Position, everything())"
"0",""
"0","gk <- one %>% cbind(prediction) %>%"
"0","  mutate(Position=""GKP"") %>%"
"0","  select(Player, Position, Predicted_Points, everything())"
"0",""
